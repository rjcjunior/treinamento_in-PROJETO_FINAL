<html class="paginaArtigo">
<style>
@import url('https://fonts.googleapis.com/css?family=Montserrat');
@import url('https://fonts.googleapis.com/css?family=Dosis');
</style>

<section id="secaoArtigo" class="container">
<div class="titulo">
  <h1>
    <%= @post.titulo %>
  </h1>
</div>

<div class="artigo">
  <%= raw @post.conteudo %>
</div>

<div class="container artigoData">
  <div class="col-md-6 criador">
    Criado por:
    <strong><%= @post.user.nome %></strong>
    em
    <%= @post.data.strftime("%d/%m/%Y às %H:%M") %>
  </div>
  
    <% if UserPost.exists?(:post_id => @post.id) %> <!-- verificar se houve modificação-->
      <%colaborador = UserPost.where(post_id:@post.id).order(:updated_at).first%> <!-- Pegar o ultimo colaborador-->
      <% User.all.each do |usuario| %>
          <%if usuario.id == colaborador.user_id %>
               Ultima modificação 
               <%= colaborador.updated_at.strftime("%d/%m/%Y às %H:%M") %> <!--Exibir a hora da ultima modificação colaborador-->
              por  <strong><%= usuario.nome  %>  <!--Exibir o nome do ultimo colaborador--></strong>
              <% break %>
          <%end %>
      <%end %>
    
    <%end %>
</div>

</section>

<div class="container-fluid text-center">
  <%= link_to '<span class="editar">Editar</span><span class="lapis"><i class="fa fa-pencil"></i></span>'.html_safe, edit_post_path(@post), class:"botaoEditar" %>
</div>

<% if @post.post_id == nil%>
<% contanswer = Post.where(post_id:@post.id).count()%> <!-- contador de respostas-->
<div class="titulo"><h2><%= contanswer%> Resposta(s)</h2></div>

<div class="home-container container-fluid">
  <%Post.order('created_at DESC').each do |post1|%> <!-- imprimir respostas -->
    <% if (@post.id==post1.post_id)%>
      <div class="home-box">
        <%=  raw post1.conteudo %>
        <div class="text-right">
          <strong><%= post1.user.nome%></strong> em <%=post1.data.strftime("%d/%m/%Y às %H:%M") %>
        
          <td><%= link_to '<i class="fa fa-pencil"></i></span>'.html_safe, edit_post_path(post1.id), class:"botaoEditar" %></td>
            
          <% if UserPost.exists?(:post_id => post1.id) %> <!-- verificar se houve modificação-->

            <%colaborador = UserPost.where(post_id:post1.id).order(:updated_at).first%> <!-- Pegar o ultimo colaborador-->
            <% User.all.each do |usuario| %>

            <%if usuario.id == colaborador.user_id %>

              <br><br>
              Modificado por <strong><%= usuario.nome  %></strong>
               em <%= colaborador.updated_at.strftime("%d/%m/%Y às %H:%M") %>
              <% break %>
    
            <%end %>
          <%end %>
            <%end %>
          </div>
          <br>
        </div>
    <%end%>
  <%end%>
  
  <%= form_for :post, url: {action: "create"} do |f| %> <!--Formulario para criar resposta -->
    <div class="field">
      <%= f.cktext_area :conteudo %>
    </div>
    
    <div class="field">
      <%= f.hidden_field :post_id, value: @post.id %>
    </div>
    
      <div class="container text-center">
    <%= link_to '<span class="voltar">Voltar</span><span class="seta"><i class="fa fa-arrow-left"></i></span>'.html_safe, posts_path, class:"botaoVoltarArtigo" %>
    <%= f.submit "Responder", class:"post-button" %><%end%>
      </div>
</div>
<%end%>
      
</html>
